clear
close

%diary processingResultsMultiUI.txt
introStatement = 'This script will process the OpenFace dataset through various face thresholds ranging from 0.30 to 0.60 in steps of 0.10.';
disp(introStatement)
filePath = uigetdir(matlabroot,'Select the folder of processed files you would like to analyze');
classifierPath = uigetdir(matlabroot,'Select the folder containing the classifierCall file.');

outputMatrix = ["FileNames", "FaceID", "FaceThreshold", "NumberOfBadFrames", "NumberOfFramesAnalyzed" "ErrorRatePercentage"]; %Header of generated output CSV file

for faceThreshold = 0.30:.10:0.60
  faceThresholdProgress = 'Now beginning processing with %d face threshold.';
  faceThresholdProgressString = sprintf(faceThresholdProgress,faceThreshold)

  cd(filePath);
  csv_files = dir('*.csv');
  for fileNumber = 1:length(csv_files)
    csv_names{fileNumber} = csv_files(fileNumber).name;
  end
  for fileLoadNumber = 1:length(csv_files)
    fileLoad = csv_names{fileLoadNumber};
    cd(classifierPath) %Location of classifier call
    OpenFaceMinMaxClassifierCallMultiUI;
  end
  completionStatement = sprintf('Processing for Face Threshold %d complete.',faceThreshold);
  disp(completionStatement)
end

outputTable = array2table(outputMatrix);
newRowNames = table2array(outputTable(1,:));
outputTable.Properties.VariableNames = newRowNames;
outputTable(1,:) = [];
cd(classifierPath);
writetable(outputTable,'outputTableMultiUI.csv')
%diary off

